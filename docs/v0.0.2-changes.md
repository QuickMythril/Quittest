# Quitter v0.0.2 code changes

All files touched in v0.0.2 and a brief description of what changed.

## Feature groups
- **Notifications & alerts** — Adds polling, storage, UI, and sound for follower/mention/reply notifications; includes badge + last-viewed tracking and snackbar preferences. Files: `src/hooks/useNotifications.ts`, `src/hooks/useNotificationStorage.ts`, `src/state/global/notifications.ts`, `src/components/NotificationsPage.tsx`, `src/components/NotificationSnackbar.tsx`, `src/components/Sidebar.tsx`, `src/components/SocialApp.tsx`, `src/routes/Routes.tsx`, `src/styles/Layout.tsx`, `src/utils/notificationStorageDB.ts`, `src/utils/notificationTimestamp.ts`, `src/utils/notificationSound.ts`.
- **Mentions in posts** — Enables @ mention highlighting, autocomplete, and clickable rendering, and embeds hashed mentions/reply markers in publish/update payloads for notifications. Files: `src/components/NewPostInput.tsx`, `src/components/Post.tsx`, `src/components/SocialApp.tsx`, `src/utils/postQdn.ts`.
- **Profile existence & follow UX** — Checks if a profile name exists with cached lookups, shows loading/not-found states, and improves follow-button loading feedback. Files: `src/hooks/useNameExists.ts`, `src/state/global/nameValidation.ts`, `src/utils/nameValidation.ts`, `src/components/UserFeed.tsx`, `src/hooks/useIsFollowing.ts`.
- **Resilience and helpers** — Clipboard fallback logging, navigation/back-stack handling for notifications route, and related wiring. Files: `src/utils/clipboard.ts`, `src/components/SocialApp.tsx`, `src/components/Sidebar.tsx`.

## Components
- src/components/NewPostInput.tsx — adds @ mention highlighting and autocomplete with Qortal name search, mention-aware formatting, and keyboard navigation for the popover.
- src/components/NotificationSnackbar.tsx — new snackbar that surfaces unread notifications at random, supports sound, and marks notifications as shown.
- src/components/NotificationsPage.tsx — new notifications screen with tabs (all/followers/mentions/replies), relative timestamps, and settings toggles for snackbar + sound.
- src/components/Post.tsx — renders mentions as clickable, updates text parsing to handle mentions, and cleans @{…} display in parent post previews.
- src/components/Sidebar.tsx — enables Notifications nav item with unread badge logic and last-viewed tracking.
- src/components/SocialApp.tsx — wires notifications route/page, global notification polling hook, snackbar, and navigation/back-stack handling.
- src/components/UserFeed.tsx — checks if a name exists with cached lookup, shows loading/not-found states, and adds loading state to follow button.

## Hooks
- src/hooks/useIsFollowing.ts — now returns `{ isFollowing, isLoading }` and manages loading lifecycle.
- src/hooks/useNameExists.ts — new hook to verify name existence with cached results and error handling.
- src/hooks/useNotificationStorage.ts — new hook to sync shown notification IDs and preferences with IndexedDB/localforage.
- src/hooks/useNotifications.ts — new polling hook that builds follower/mention/reply notifications from QDN resources and preserves unread status.

## State
- src/state/global/nameValidation.ts — new cache atom and constants for name existence checks.
- src/state/global/notifications.ts — new atoms for notifications list, unread badge, snackbar/sound prefs, and tracking which user they belong to.

## Routing/Layout
- src/routes/Routes.tsx — adds `/notifications` route.
- src/styles/Layout.tsx — initializes notification storage sync at app bootstrap.

## Utilities
- src/utils/clipboard.ts — improves clipboard fallback with error handling before legacy path.
- src/utils/nameValidation.ts — new helper to fetch `/names/{name}` and report existence/errors.
- src/utils/notificationSound.ts — new Web Audio chime for notification alerts.
- src/utils/notificationStorageDB.ts — new localforage-backed store for shown notification IDs and preferences (with stale cleanup).
- src/utils/notificationTimestamp.ts — tracks last viewed notifications per user in localStorage.
- src/utils/postQdn.ts — embeds hashed mentions and reply markers into publish/update descriptions for notifications, keeping hashtag keyword handling intact.
